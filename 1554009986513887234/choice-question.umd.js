(function(p,d){typeof exports=="object"&&typeof module!="undefined"?module.exports=d():typeof define=="function"&&define.amd?define(d):(p=typeof globalThis!="undefined"?globalThis:p||self,p.ChoiceQuestion=d())})(this,function(){"use strict";var n={"Question-Box":"_Question-Box_18tp1_1",Question:"_Question_18tp1_1","Input-Box":"_Input-Box_18tp1_11",Icon:"_Icon_18tp1_17",Input:"_Input_18tp1_11",OptionList:"_OptionList_18tp1_32",Item:"_Item_18tp1_32",Selected:"_Selected_18tp1_46",Action:"_Action_18tp1_52",Button:"_Button_18tp1_61"};return({options:B})=>{const{input:f,onExecuted:x,onChange:R,mode:h="display",api:{showRichText:y,showRichEditor:C}}=B,[m,E]=React.useState(""),[s,_]=React.useState(!1),[i,u]=React.useState([]),[g,A]=React.useState(),[l,N]=React.useState(h==="edit"),b=React.useRef(),I=React.useCallback(e=>y(e),[]),k=React.useCallback(e=>C(e),[]);React.useEffect(()=>{if(!b.current)try{const e=JSON.parse(f);e.question&&E(e.question),e.multiple&&_(e.multiple),e.optionList&&u(e.optionList.map(t=>({text:t,selected:!1}))),b.current=!0}catch(e){console.log(e)}},[f]),React.useEffect(()=>{if(!R)return;const e={question:m,multiple:s,optionList:i.map(t=>t.text)};R(JSON.stringify(e))},[m,s,i]);const r=React.useMemo(()=>{const e=i.map((t,c)=>({...t,index:c})).filter((t,c)=>t.selected).map(t=>t.index).sort();if(e.length!==0)return s?e.join():`${e[0]}`},[s,i]),S=React.useCallback(()=>{A(r),x(r)},[r]),Q=React.useCallback(()=>{u(e=>e.concat([{text:""}]))},[]),v=React.useCallback(e=>{u(t=>(t.splice(e,1),Array.from(t)))},[]),w=React.useCallback((e,t)=>{u(s?c=>(c.forEach((o,a)=>{a===t&&(o.selected=!o.selected)}),Array.from(c)):c=>(c.forEach((o,a)=>{a===t?o.selected=!o.selected:o.selected=!1}),Array.from(c)))},[s]);return React.createElement("div",{className:n["Question-Box"]},React.createElement("div",{className:n.Question},l?React.createElement(k,{className:n.Input,options:{image:!0,heading:!0,codeBlock:!0,blockQuote:!0,subscript:!0},placeholder:"\u9898\u76EE",defaultValue:m,onChange:e=>{E(e)}}):React.createElement(I,{html:m})),React.createElement("div",{className:n.OptionList},i.map((e,t)=>l?React.createElement("div",{key:t,className:n["Input-Box"]},React.createElement(k,{className:`${n.Input} ${n.Item}`,options:{image:!0,heading:!0,codeBlock:!0,blockQuote:!0,subscript:!0},placeholder:"\u9009\u9879",defaultValue:e.text,onChange:c=>{u(o=>{const a=Array.from(o);return a[t]={...a[t],text:c},a})}}),React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",onClick:()=>{v(t)},className:n.Icon,fill:"#ef4444"},React.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),React.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4 11H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1z"}))):React.createElement("div",{key:t,className:`${n.Item} ${e.selected?n.Selected:""}`,onClick:()=>{w(e,t)}},React.createElement(I,{html:e.text})))),React.createElement("div",{className:n.Action},React.createElement("button",{disabled:!r||r===g,type:"button",onClick:S,className:n.Button},"\u63D0\u4EA4"),l&&React.createElement("button",{type:"button",onClick:Q,className:n.Button},"\u65B0\u589E"),l&&React.createElement("button",{type:"button",onClick:()=>{_(e=>!e)},className:n.Button},s?"\u591A\u9009":"\u5355\u9009"),h==="edit"&&React.createElement("button",{type:"button",onClick:()=>{N(e=>!e)},className:n.Button},l?"\u666E\u901A\u6A21\u5F0F":"\u7F16\u8F91\u6A21\u5F0F")))}});
